---
title: "TP1"
output: html_notebook
---

```{r}
library(dplyr)
library(car)
library(ggfortify)
library(GGally)
library(ggplot2)
library(rmarkdown)
library(FactoMineR)
```

```{r}
x <- c(1,2,3,4)

m <- mean(x)

y <- x - m

print(mean(y) == 0)

t(y)

(y%*%y)
```

```{r}
temp <- read.csv("temperature.csv", sep = ";", dec= ",",row.names=1)
paged_table(temp)

X <- as.matrix(temp)

Y <- X - rep(1,nrow(X)) %*% t(colMeans(X))

V <- t(Y) %*% diag(1/nrow(Y), nrow = nrow(Y), ncol = nrow(Y)) %*% Y

eig <- eigen(V)
vp <- eig$values


I <- sum(vp)

taux <- matrix(,nrow = nrow(V),ncol = 1)
for (i in (1 : nrow(V))){
  taux[i] = vp[i]/sum(vp)
}

cumul <- matrix(,nrow = nrow(V),ncol = 1)
for (i in (1 : nrow(V))){
  cumul[i] = sum(vp[1:i])/sum(vp)
}

VP <- eig$vectors[,1:2]

P <- Y %*% VP

plot(P)
text(P,row.names(P))
axis(1,-10:10,pos=0,labels=FALSE)
axis(2,-5:5,pos=0,labels=FALSE)

C <- P %*% matrix(c(0,-1,1,0), nrow = 2 , ncol = 2)
plot(C)
text(C,row.names(C))
axis(1,-10:10,pos=0,labels=FALSE)
axis(2,-5:5,pos=0,labels=FALSE)

QLT <- matrix(,nrow = nrow(P),ncol = ncol(P))
for (i in (1:nrow(Y))){
  QLT[i,1] <- sum((P[1]/(t(Y[i,])%*% Y[i,]))^2)
  QLT[i,2] <- sum((P[2]/(t(Y[i,])%*% Y[i,]))^2)
}

CTR <- 1/nrow(Y) * P^2 / vp[1:2]
```

```{r}
matrix(c(round(eig$values,digits = 2),
round(100*taux,digits = 2),
round(100*cumul,digits = 2)),nrow = length(eig$values),ncol = 3)

round(CTR,digits = 2)
```

```{r}
round(T.pca$eig,2)
round(T.pca$ind$dist,2)
round(T.pca$ind$contrib[,1:2],2)
round(T.pca$var$contrib[,1:2],2)
```


```{r}
T=read.csv("temperature.csv", sep = ";", dec= ",",row.names = 1)
summary(T)
T.pca <- PCA(T)
```

```{r}
"Amiens" <-c( 3.1,3.8 ,6.7,9.5,12.8,15.8,17.6,17.6,15.5,11.1,6.8,4.2)
T<-rbind(T, Amiens)
row.names(T)[16]<-"Amiens"

Moscow<- c(-9.2,-8,-2.5,5.9 ,12.8,16.8,18.4,16.6,11.2,4.9,-1.5,-6.2)
T<-rbind(T, Moscow)
row.names(T)[17]<-"Moscow"

Marrakech<-c(11.3 ,12.8,15.8,18.1,21.2,24.7,28.6,28.6,25,20.9,15.9,12.1)
T<-rbind(T, Marrakech)
row.names(T)[18]<-"Marrakech"

T.pca <- PCA(T,ind.sup=16:18)
```


