library(dplyr)
library(rmarkdown)
library(corrplot)
install.packages("corrplot")
library(dplyr)
library(rmarkdown)
library(MASS)
library(corrplot)
library(dplyr)
library(rmarkdown)
library(MASS)
library(ggplot2)
library(ggfortify)
library(car)
ozone <- read.csv("ozone.txt",header = T, sep = "", dec = "." )
ozone$vent <- as.factor(ozone$vent)
ozone$temps <- as.factor(ozone$temps)
mod <- lm(maxO3 ~ T12,data = ozone )
summary(mod)
autoplot(mod,1:4)
durbinWatsonTest(mod)
mod_vent <- lm(maxO3 ~ vent , data = ozone)
mod_temps <- lm(maxO3 ~ temps, data = ozone)
mod_both <- lm(maxO3 ~ temps  vent , data = ozone)
mod_vent <- lm(maxO3 ~ vent , data = ozone)
mod_temps <- lm(maxO3 ~ temps, data = ozone)
mod_both <- lm(maxO3 ~ temps * vent , data = ozone)
library(dplyr)
library(rmarkdown)
library(MASS)
library(ggplot2)
library(ggfortify)
library(car)
ozone <- read.csv("ozone.txt",header = T, sep = "", dec = "." )
ozone$vent <- as.factor(ozone$vent)
ozone$temps <- as.factor(ozone$temps)
mod <- lm(maxO3 ~ T12,data = ozone )
summary(mod)
autoplot(mod,1:4)
durbinWatsonTest(mod)
mod_vent <- lm(maxO3 ~ vent , data = ozone)
mod_temps <- lm(maxO3 ~ temps, data = ozone)
mod_both <- lm(maxO3 ~ temps * vent , data = ozone)
summary(mod_vent)
autoplot(mod_temps,1:4)
durbinWatsonTest(mod_temps)
summary(mod_temps)
autoplot(mod_vent,1:4)
durbinWatsonTest(mod_vent)
summary(mod_both)
autoplot(mod_both,1:4)
durbinWatsonTest(mod_both)
mod_all <- lm(maxO3 ~., data = ozone)
summary(mod_all)
autoplot(mod_all,1:4)
durbinWatsonTest(mod_all)
ggpairs(ozone, progress = F)
library(dplyr)
library(rmarkdown)
library(MASS)
library(ggplot2)
library(ggfortify)
library(car)
ozone <- read.csv("ozone.txt",header = T, sep = "", dec = "." )
ozone$vent <- as.factor(ozone$vent)
ozone$temps <- as.factor(ozone$temps)
mod <- lm(maxO3 ~ T12,data = ozone )
summary(mod)
autoplot(mod,1:4)
durbinWatsonTest(mod)
mod_vent <- lm(maxO3 ~ vent , data = ozone)
mod_temps <- lm(maxO3 ~ temps, data = ozone)
mod_both <- lm(maxO3 ~ temps * vent , data = ozone)
summary(mod_vent)
autoplot(mod_temps,1:4)
durbinWatsonTest(mod_temps)
summary(mod_temps)
autoplot(mod_vent,1:4)
durbinWatsonTest(mod_vent)
summary(mod_both)
autoplot(mod_both,1:4)
durbinWatsonTest(mod_both)
mod_all <- lm(maxO3 ~., data = ozone)
summary(mod_all)
autoplot(mod_all,1:4)
durbinWatsonTest(mod_all)
ggpairs(ozone, progress = F)
library(dplyr)
library(rmarkdown)
library(MASS)
library(ggplot2)
library(GGally)
library(ggfortify)
library(car)
ggpairs(ozone, progress = F)
ggpairs(ozone, progress = FALSE)
autoplot(mod_vent,1:4)
summary(mod_vent)
#ANOVA regression of max03 against vent
autoplot(mod_vent,1:4)7
#ANOVA regression of max03 against vent
autoplot(mod_vent,1:4)
durbinWatsonTest(mod_vent)
summary(mod_vent)
library(dplyr)
library(rmarkdown)
library(MASS)
library(ggplot2)
library(GGally)
library(ggfortify)
library(car)
#loading data set
ozone <- read.csv("ozone.txt",header = T, sep = "", dec = "." )
ozone$vent <- as.factor(ozone$vent)
ozone$temps <- as.factor(ozone$temps)
#simple linear model of maxO3 against T12
mod <- lm(maxO3 ~ T12,data = ozone )
summary(mod)
#simple linear regression of max03 against T12
autoplot(mod,1:4)
durbinWatsonTest(mod)
#ANOVA models
mod_vent <- lm(maxO3 ~ vent , data = ozone)          #maxO3 against vent
mod_temps <- lm(maxO3 ~ temps, data = ozone)         #maxO3 against temps
mod_both <- lm(maxO3 ~ temps * vent , data = ozone)  #maxO3 against temps + vent + temps:vent
summary(mod_temps)
#ANOVA regression of max03 against temps
autoplot(mod_temps,1:4)
durbinWatsonTest(mod_temps)
summary(mod_vent)
#ANOVA regression of max03 against vent
autoplot(mod_vent,1:4)
durbinWatsonTest(mod_vent)
summary(mod_both)
#ANOVA regression of max03 against temps and vent
autoplot(mod_both,1:4)
durbinWatsonTest(mod_both)
#multiple linear model of max03 against all the co variables
mod_full <- lm(maxO3 ~., data = ozone)
summary(mod_full)
#multiple linear regression of max03 against all the co variables
autoplot(mod_full,1:4)
durbinWatsonTest(mod_full)
ggpairs(ozone, progress = FALSE)
modForw <- stepAIC(mod_all, maxO3 ~ maxO3 + T9 + T12 + T15 + Ne9 + Ne12 + Ne15 + Vx9 + Vx12 + Vx15 + maxO3v + vent + temps,trace=F, direction=c("forward"))
summary(modForw)
modBack <- stepAIC(mod_all, maxO3 ~. ,trace=F, direction=c("backward"))
summary(modBack)
modBoth <- stepAIC(mod_all, maxO3 ~ maxO3 + T9 + T12 + T15 + Ne9 + Ne12 + Ne15 + Vx9 + Vx12 + Vx15 + maxO3v + vent + temps ,trace=F, direction=c("both"))
summary(modBoth)
AIC(modForw,modBack,modBoth)
new <- data.frame(T12=18, Ne9=3, Vx9=0.7, maxO3v=85)
predict(modBack, new, interval = "confidence")
library(dplyr)
library(rmarkdown)
library(MASS)
library(ggplot2)
library(GGally)
library(ggfortify)
library(car)
#loading data set
ozone <- read.csv("ozone.txt",header = T, sep = "", dec = "." )
ozone$vent <- as.factor(ozone$vent)
ozone$temps <- as.factor(ozone$temps)
#simple linear model of maxO3 against T12
mod <- lm(maxO3 ~ T12,data = ozone )
summary(mod)
#simple linear regression of max03 against T12
autoplot(mod,1:4)
durbinWatsonTest(mod)
#ANOVA models
mod_vent <- lm(maxO3 ~ vent , data = ozone)          #maxO3 against vent
mod_temps <- lm(maxO3 ~ temps, data = ozone)         #maxO3 against temps
mod_both <- lm(maxO3 ~ temps * vent , data = ozone)  #maxO3 against temps + vent + temps:vent
summary(mod_temps)
#ANOVA regression of max03 against temps
autoplot(mod_temps,1:4)
durbinWatsonTest(mod_temps)
summary(mod_vent)
#ANOVA regression of max03 against vent
autoplot(mod_vent,1:4)
durbinWatsonTest(mod_vent)
summary(mod_both)
#ANOVA regression of max03 against temps and vent
autoplot(mod_both,1:4)
durbinWatsonTest(mod_both)
#multiple linear model of max03 against all the co variables
mod_full <- lm(maxO3 ~., data = ozone)
summary(mod_full)
#multiple linear regression of max03 against all the co variables
autoplot(mod_full,1:4)
durbinWatsonTest(mod_full)
#test if we have interaction between co variables
ggpairs(ozone, progress = FALSE)
modForw <- stepAIC(mod_all, maxO3 ~ maxO3 + T9 + T12 + T15 + Ne9 + Ne12 + Ne15 + Vx9 + Vx12 + Vx15 + maxO3v + vent + temps,trace=F, direction=c("forward"))
summary(modForw)
modBack <- stepAIC(mod_all, maxO3 ~. ,trace=F, direction=c("backward"))
summary(modBack)
modBoth <- stepAIC(mod_all, maxO3 ~ maxO3 + T9 + T12 + T15 + Ne9 + Ne12 + Ne15 + Vx9 + Vx12 + Vx15 + maxO3v + vent + temps ,trace=F, direction=c("both"))
summary(modBoth)
#test to know witch model is the best
AIC(modForw,modBack)
#set a new individual
new <- data.frame(T12=18, Ne9=3, Vx9=0.7, maxO3v=85)
#look is we can well predict this individual
predict(modBack, new, interval = "confidence")
